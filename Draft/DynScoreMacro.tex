\documentclass[letterpaper,12pt]{article}

\usepackage{threeparttable}
\usepackage{geometry}
\geometry{letterpaper,tmargin=1in,bmargin=1in,lmargin=1.25in,rmargin=1.25in}
\usepackage[format=hang,font=normalsize,labelfont=bf]{caption}
\usepackage{amsmath}
\usepackage{multirow}
\usepackage{array}
\usepackage{delarray}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{lscape}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{float,color}
\usepackage[pdftex]{graphicx}
\usepackage{pdfsync}
\usepackage{verbatim}
\synctex=1
\usepackage{hyperref}
\hypersetup{colorlinks,linkcolor=red,urlcolor=blue,citecolor=red}
\usepackage{bm}
\theoremstyle{definition}
\newtheorem{theorem}{Theorem}
\newtheorem{acknowledgement}[theorem]{Acknowledgement}
\newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{axiom}[theorem]{Axiom}
\newtheorem{case}[theorem]{Case}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{conclusion}[theorem]{Conclusion}
\newtheorem{condition}[theorem]{Condition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{criterion}[theorem]{Criterion}
\newtheorem{definition}{Definition} % Number definitions on their own
\newtheorem{derivation}{Derivation} % Number derivations on their own
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{proposition}{Proposition} % Number propositions on their own
\newtheorem{remark}[theorem]{Remark}
\newtheorem{solution}[theorem]{Solution}
\newtheorem{summary}[theorem]{Summary}
\bibliographystyle{aer}
\newcommand\ve{\varepsilon}
\renewcommand\theenumi{\roman{enumi}}
\providecommand{\norm}[1]{\lVert#1\rVert}

\begin{document}

\begin{titlepage}
\title{A Macroeconomic Model for \\
       Dynamic Scoring of Tax Policy
       \thanks{
       Put thanks here.}
       }
\author{
  Richard W. Evans\footnote{Brigham Young University, Department of Economics, 167 FOB, Provo, Utah 84602, (801) 422-8303, \href{mailto:revans@byu.edu}{revans@byu.edu}.} \\[-2pt]
  \and
  Evan Magnusson\footnote{Brigham Young University, Department of Economics, 163 FOB, Provo, Utah 84602, \href{mailto:evanmag42@gmail.com}{evanmag42@gmail.com}.} \\[-2pt]
  \and
  Kerk L. Phillips\footnote{Brigham Young University, Department of Economics, 166 FOB, Provo, Utah 84602, (801) 422-5928, \href{mailto:kerk_phillips@byu.edu}{kerk\_phillips@byu.edu}.} \\[-2pt]
  \and
  Isaac Swift\footnote{Brigham Young University, Department of Economics, 163 FOB, Provo, Utah 84602, \href{mailto:isaacdswift@gmail.com}{isaacdswift@gmail.com}.} \\[-2pt]}
\date{July 2014 \\
  \scriptsize{(version 14.07.b)}}
\maketitle
\begin{abstract}
\normalsize{Put abstract here.

\vspace{3mm}

\noindent\textit{keywords:}\: Put keywords here.

\vspace{3mm}

\noindent\textit{JEL classification:} Put JEL codes here.}
\end{abstract}
\thispagestyle{empty}
\end{titlepage}


\begin{spacing}{1.5}

\section{Introduction}\label{SecIntro}

  Put introduction here.


\section{Model}\label{SecModel}

  Model intro here.


  \subsection{Individual problem}\label{SecIndProb}

    A measure $1/S$ of individuals with heterogeneous working ability $e \in\mathcal{E}\subset\mathbb{R}_{++}$ is born in each period $t$ and live for $S\geq 3$ periods. Their working ability evolves over their lifetime according to an age-dependent deterministic process. At birth, a fraction $1/J$ of the $1/S$ measure of new agents are randomly assigned to one of $J$ ability types indexed by $j=1,2,...J$. Once ability type is determined, that measure $1/(SJ)$ of individuals' ability evolves deterministically according to $e_j(s)$. We calibrate the matrix of lifetime ability paths $e_j(s)$ for all types $j$ using CPS hourly wage by age distribution data.\footnote{Appendix \ref{AppAbilCalib} gives a detailed description of the calibration of the deterministic ability process by age $s$ and type $j$, as well as alternative specifications and calibrations.}

    Individuals are endowed with a measure of time in each period $t$ that they supply inelastically to the labor market. Let $s$ represent the periods that an individual has been alive. The fixed labor supply in each period $t$ by each age-$s$ individual is denoted by $l(s)$.

    At time $t$, all generation $s$ agents with ability $e_j(s)$ know the real wage rate $w_t$ and know the one-period real net interest rate $r_t$ on bond holdings $b_{j,s,t}$ that mature at the beginning of period $t$. In each period $t$, age-$s$ agents with working ability $e$ choose how much to consume $c_{j,s,t}$ and how much to save for the next period by loaning capital to firms in the form of a one-period bond $b_{j,s+1,t+1}$ in order to maximize expected lifetime utility of the following form,
    \begin{equation}\label{EqUtilMax}
      U_{j,s,t} = \sum_{v=0}^{S-s}\beta^u u\left(c_{j,s+u,t+u}\right) \quad \text{where} \quad u\left(c_{j,s,t}\right) = \frac{\left(c_{j,s,t}\right)^{1-\sigma} - 1}{1-\sigma} \quad\forall j,s,t
    \end{equation}
    where $u(c)$ is a constant relative risk aversion utility function, $\sigma\geq 1$ is the coefficient of relative risk aversion, and $\beta\in(0,1)$ is the agent's discount factor.

    Because agents are born without any bonds maturing and because they purchase no bonds in the last period of life $s=S$, the per-period budget constraints for each agent normalized by the price of consumption are the following.
    \begin{align}
      w_t e_j(s)l(s) &\geq c_{j,s,t} + b_{j,s+1,t+1} \quad \text{for} \quad s = 1 \quad\quad\quad\quad\:\:\: \forall j,t \label{EqBC1} \\
      \left(1 + r_t\right) b_{j,s,t} + w_t e_j(s)l(s) &\geq c_{j,s,t} + b_{j,s+1,t+1} \quad \text{for} \quad 2\leq s \leq S-1 \quad \forall j,t \label{EqBC2} \\
      \left(1 + r_t\right) b_{j,s,t} + w_t e_j(s)l(s) &\geq c_{j,s,t} \quad\quad\quad\quad\quad\quad \text{for} \quad s = S \quad\quad\quad\quad\:\:\, \forall j,t \label{EqBC3}
    \end{align}
    Note that the price of consumption is normalized to one, so $w_t$ is the real wage and $r_t$ is the real net interest rate.

    In addition to the budget constraints in each period, the utility function imposes nonnegative consumption through inifinite marginal utility. We allow the possibility for individual agents to borrow $b_{j,s,t}<0$ for some $j$ and $s$ in period $t$. However, the borrowing must satisfy a series of individual feasibility constraints as well as a strict constraint that the aggregate capital stock $K_t>0$ be positive in every period.\footnote{We describe these constraints in detail in Appendix \ref{AppBorConstr}.}

    We next describe the Euler equations that govern the choices of consumption $c_{j,s,t}$ and savings $b_{j,s+1,t+1}$ by household of age $s$ and ability $e_j(s)$ in each period $t$. We work backward from the last period of life $s = S$. Because households do not save in the last period of life $b_{j,s+1,t+1}=0$ due to our assumption of no bequest motive, the household's final-period maximization problem is given by the following.
    \begin{equation}\label{EqSmaxprob}
      \max_{c_{j,S,t}} \frac{\left(c_{j,S,t}\right)^{1-\sigma} - 1}{1 - \sigma} \quad \text{s.t.} \quad \left(1+r_t\right)b_{j,S,t} + w_t e_j(S)l(S) \geq c_{j,S,t} \quad \forall t
    \end{equation}
    Because $u(c)$ is monotonically increasing in $c$, the $s=S$ problem \eqref{EqSmaxprob} is simply to choose the maximum amount of consumption possible. The household trivially consumes all of its income in the last period of life.
    \begin{equation}\label{EqScons}
      c_{j,S,t} = \left(1+r_t\right)b_{j,S,t} + w_t e_j(S)l(S) \quad \forall t
    \end{equation}

    In general, maximizing \eqref{EqUtilMax} with respect to \eqref{EqBC1}, \eqref{EqBC2}, \eqref{EqBC3}, and the implied individual and aggregate borrowing constraints gives the following set of $S-1$ intertemporal Euler equations.
    \begin{equation}\label{EqIntertempEuler}
      \begin{split}
        \left(c_{j,s,t}\right)^{-\sigma} = \beta \left(1+r_{t+1}\right)\left(c_{j,s+1,t+1}\right)^{-\sigma} \\
        \text{for} \quad 1\leq s\leq S-1, \quad \forall t
      \end{split}
    \end{equation}
    Note from \eqref{EqBC2} that $c_{j,s,t}$ in \eqref{EqIntertempEuler} depends on the household's age $s$, his ability $e_j(s)$, and the initial wealth with which the household entered the period $b_{j,s,t}$.


  \subsection{Firm problem}\label{SecModelGenFirm}

    A unit measure of identical, perfectly competitive firms exist in this economy. The representative firm is characterized by the following Cobb-Douglas production technology,
    \begin{equation}\label{EqCobbDougProd}
       Y_t = A K_t^\alpha L_t^{1-\alpha} \quad \forall t
    \end{equation}
    where $A$ is the fixed technology process and $\alpha\in(0,1)$ and $L_t$ is measured in efficiency units of labor. The interest rate $r_t$ in the cost function is a net real interest rate because depreciation $\delta$ is paid by the firms. The real wage is $w_t$. The real profit function of the firm is the following.
    \begin{equation}\label{EqFirmProfit}
       \text{Real Profits} = A K_t^\alpha L_t^{1-\alpha} - (r_t + \delta)K_t - w_t L_t
    \end{equation}
    As in the budget constraints \eqref{EqBC1}, \eqref{EqBC2}, and \eqref{EqBC3}, note that the price of the good has been normalized to one.

    Profit maximization results in the real wage $w_t$ and the real rental rate of capital $r_t$ being determined by the marginal products of labor and capital, respectively.
    \begin{align}
       w_t &= (1-\alpha)\frac{Y_t}{L_t} \quad \forall t \label{EqFOCwage}\\
       r_t &= \alpha\frac{Y_t}{K_t} - \delta \quad\:\:\: \forall t \label{EqFOCrate}
    \end{align}


  \subsection{Market clearing and equilibrium}\label{SecMCandEqlbm}

    Labor market clearing requires that aggregate labor demand $L_t$ measured in efficiency units equal the sum of individual efficiency labor supplied $e_j{s}l(s)$. The supply side of market clearing in the labor market is trivial because household labor is supplied inelastically. Capital market clearing requires that aggregate capital demand $K_t$ equal the sum of capital investment by households $b_{j,s,t}$. Aggregate consumption $C_t$ is defined as the sum of all individual consumptions, and investment is defined by the standard $Y = C + I$ constraint as shown in \eqref{EqMktClrGoods}.
    \begin{align}
      L_t &= \frac{1}{SJ}\sum_{s=1}^S\sum_{j=1}^{J} e_j(s)l(s) \quad\quad \forall t \label{EqMktClrLab} \\
      K_t &= \frac{1}{SJ}\sum_{s=1}^{S}\sum_{j=1}^{J}b_{j,s,t} \quad\quad\quad\quad \forall t \label{EqMktClrCap} \\
      \begin{split}
        Y_t &= C_t + K_{t+1} - (1-\delta)K_t \quad\forall t \\
        &\quad\text{where}\quad C_t \equiv \frac{1}{SJ}\sum_{s=1}^{S}\sum_{j=1}^{J}c_{j,s,t}
      \end{split} \label{EqMktClrGoods}
    \end{align}
    The steady-state equilibrium for this economy is defined as follows.

    \vspace{7mm}
    \end{spacing}
    \hrule
    \begin{definition}[\textbf{Steady-state equilibrium}]\label{DefEquilSS}
      A non-autarkic steady-state equilibrium in the overlapping generations model with $S$-period lived agents and heterogeneous ability $e_j(s)$ is defined as constant allocations $c_{j,s,t}=\bar{c}_{j,s}$ and $b_{j,s+1,t+1}=\bar{b}_{j,s+1}$ and constant prices $w_t=\bar{w}$ and $r_t=\bar{r}$ for all $j$, $s$, and $t$ such that the following conditions hold:
       \begin{enumerate}
          \item households optimize according to \eqref{EqSmaxprob}, \eqref{EqScons} and \eqref{EqIntertempEuler},
          \item firms optimize according to \eqref{EqFOCwage} and \eqref{EqFOCrate}, and
          \item markets clear according to \eqref{EqMktClrLab}, \eqref{EqMktClrCap}, and \eqref{EqMktClrGoods}.
       \end{enumerate}
    \end{definition}
    \hrule
    \begin{spacing}{1.5}
    \vspace{10mm}

    The steady-state equilibrium is characterized by the system of $J\times(S-1)$ equations and $J\times(S-1)$ unknowns $\bar{b}_{j,s+1}$ along with the individual borrowing constraints and aggregate borrowing constraint described in Appendix \ref{AppBorConstr}.

    \begin{equation}\label{EqSSeuler}
      \begin{split}
        &\left(\bar{c}_{j,s}\right)^{-\sigma} = \beta \left(1+\bar{r}\right)\left(\bar{c}_{j,s+1}\right)^{-\sigma}, \quad 1\leq s\leq S-1 \\
        &\quad\quad\quad\quad\quad\quad\quad\text{or} \\
        &\Bigl([1+\bar{r}]\bar{b}_{j,s} + \bar{w}e_j(s)l(s) - \bar{b}_{j,s+1}\Bigr)^{-\sigma} = \\
        &\quad\quad\quad\quad\quad \beta(1+\bar{r})\Bigl([1+\bar{r}]\bar{b}_{j,s+1} + \bar{w}e_j(s+1)l(s+1) - \bar{b}_{j,s+2}\Bigr)^{-\sigma}, \\
        &\quad\quad\quad\quad\quad \text{for} \quad 1\leq s\leq S-1,\quad\text{where}\quad \bar{b}_{j,1},\bar{b}_{j,S+1} = 0 \quad\forall j
      \end{split}
    \end{equation}

    In equilibrium, the steady-state real wage $\bar{w}$ and the steady-state real rental rate $\bar{r}$ are simply functions of the steady-state distribution of capital $\bar{b}_{j,s+1}$. This is clear from the steady-state version of the capital market clearing condition \eqref{EqMktClrCap} and the fact that aggregate labor supply is a function of the sum of exogenous efficiency units of labor in the labor market clearing condition \eqref{EqMktClrLab}. And the two firm first order conditions for the real wage $w_t$ \eqref{EqFOCwage} and real rental rate $r_t$ \eqref{EqFOCrate} are only functions of the aggregate capital stock $K_t$ and aggregate labor $L_t$. Appendix \ref{AppSSsolve} details how to solve for the steady-state equilibrium.

    The definition of the non-steady-state equilibrium is similar to Definition \ref{DefEquilSS}, with the steady-state equilibrium definition being a special case of the non-steady-state equilibrium.

    \vspace{7mm}
    \end{spacing}
    \hrule
    \begin{definition}[\textbf{Non-steady-state equilibrium}]\label{DefEquilNonSS}
      A non-autarkic non-steady-state equilibrium in the overlapping generations model with $S$-period lived agents and heterogeneous ability $e_j(s)$ is defined as allocations $c_{j,s,t}$ and $b_{j,s+1,t+1}$ and prices $w_t$ and $r_t$ for all $j$, $s$, and $t$ such that the following conditions hold:
       \begin{enumerate}
          \item households optimize according to \eqref{EqSmaxprob}, \eqref{EqScons} and \eqref{EqIntertempEuler},
          \item firms optimize according to \eqref{EqFOCwage} and \eqref{EqFOCrate}, and
          \item markets clear according to \eqref{EqMktClrLab}, \eqref{EqMktClrCap}, and \eqref{EqMktClrGoods}.
       \end{enumerate}
    \end{definition}
    \hrule
    \begin{spacing}{1.5}
    \vspace{10mm}

    \noindent The household saving decision in the last period of life shows that the optimal saving for age $s=S$ is a function of individual holdings of savings and prices this period and next $b_{j,S,t+1}=\psi\bigl(b_{j,S-1,t},w_t,r_t,w_{t+1},r_{t+1}\bigr)$. This decision is characterized by the final period Euler equation.
    \begin{equation}\label{EqEulerSm1}
      \begin{split}
        &\Bigl([1+r_t]b_{j,S-1,t} + w_t e_j(S-1)l(S-1) - b_{j,S,t+1}\Bigr)^{-\sigma} = \\
        &\quad\quad\quad\quad\quad \beta(1+r_{t+1})\Bigl([1+r_{t+1}]b_{j,S,t+1} + w_{t+1}e_j(S)l(S)\Bigr)^{-\sigma} \quad\forall j,t
      \end{split}
    \end{equation}

    If we substitute in the solution $\psi\bigl(b_{j,S-1,t},w_t,r_t,w_{t+1},r_{t+1}\bigr)$ to \eqref{EqEulerSm1} to the previous period's problem of how much to save for the second-to-last period of life, we see that the optimal saving decision is the following function,
    \begin{equation}\label{EqEulerSm2}
      \begin{split}
        &\Bigl([1+r_{t-1}]b_{j,S-2,t-1} + w_{t-1} e_j(S-2)l(S-2) - b_{j,S-1,t}\Bigr)^{-\sigma} = \\
        &\quad \beta(1+r_t)\Bigl([1+r_t]b_{j,S-1,t} + w_{t}e_j(S-1)l(S-1) - \psi_{j,S,t+1}\Bigr)^{-\sigma} \quad\forall j,t
      \end{split}
    \end{equation}
    where $\psi_{j,S,t+1}$ is short hand notation for $b_{j,S,t+1}=\psi(b_{j,S-1,t},w_t,r_t,w_{t+1},r_{t+1})$. Equation \eqref{EqEulerSm2}, in conjunction with \eqref{EqEulerSm1}, show that the optimal household decision in the third-to-last period of life of how much to save for the second-to-last period of life is a function of current savings and the remaining lifetime series of prices $b_{j,S-1,t}=\psi\bigl(b_{j,S-2,t-1},(w_v,r_v)_{v=t-1}^{t+1}\bigr)$. By backward induction, we can show that the solution to the households saving decision in any period is a function of their current holdings of savings and the series of prices over the rest of their life.
    \begin{equation}\label{EqPsiGen}
      b_{j,s+1,t+1} = \psi\Bigl(b_{j,s,t},(w_v,r_v)_{v=t}^{t+S-s}\Bigr) \quad\forall j,t \quad\text{and}\quad 1\leq s\leq S-1
    \end{equation}

    Each optimal saving decision for each household requires knowledge of at least todays prices and tomorrows prices and at most $S$ periods of prices. In equilibrium, one can see that the prices $(w_t,r_t)$ in each period $t$ are functions of the entire distribution of savings $b_{j,s,t}$ for all $j$ and $s$. This is clear from the steady-state version of the capital market clearing condition \eqref{EqMktClrCap} and the fact that aggregate labor supply is a function of the sum of exogenous efficiency units of labor in the labor market clearing condition \eqref{EqMktClrLab}. And the two firm first order conditions for the real wage $w_t$ \eqref{EqFOCwage} and real rental rate $r_t$ \eqref{EqFOCrate} are only functions of the aggregate capital stock $K_t$ and aggregate labor $L_t$. The requirement that individuals be able to forecast prices with perfect foresight over their lifetimes implies that each individual has correct information and beliefs about all the other individuals optimization problems and information.

    To solve for any non-steady-state equilibrium time path of the economy from an arbitrary current state to the steady state, we follow the time path iteration (TPI) method of \citet{AuerbachKotlikoff:1987}. Appendix \ref{AppNonSSsolve} details how to solve for the non-steady-state equilibrium time path using the TPI method.




% \section{Transition Path Solution Methods}\label{SecSolMeths}

% This section outlines the benchmark time path iteration (TPI) method for solving the non-steady-state rational expectations equilibrium transition path of the distribution of savings and then details our new alternate model forecast (AMF) method for computing the equilibrium transition path. Because the AMF method represents an approximation of the rational expectations assumption, we compare the AMF method to the benchmark TPI method in terms of both speed and accuracy in the context of the model from Section \ref{SecModelGen}. This model has enough heterogeneity to match the varied richness and computational complexity of equilibrium transition paths in current life cycle models.


% \subsection{Benchmark: Time path iteration}\label{SecSolMethsTPI}

% The most common method of solving for non-steady-state equilibrium transition path for the capital distribution in OLG models is finding a fixed point for the transition path of the distribution of capital for a given initial state of the distribution of capital. This solution method is detailed for the perfect foresight case in \citet[ch. 4]{AuerbachKotlikoff:1987} and for the stochastic case in \citet[Appendix II]{NishiyamaSmetters:2007}. The idea is that the economy is infinitely lived, even though the agents that make up the economy are not. Rather than recursively solving for equilibrium policy functions by iterating on individual value functions, one must recursively solve for the policy functions by iterating on the entire transition path of the endogenous objects in the economy (see \citet[ch. 17]{StokeyLucas:1989}).

% The key assumption is that the economy will reach the steady-state equilibrium $\bar{\Gamma}$ described in Definition \ref{DefModelGenEquilSS} in a finite number of periods $T<\infty$ regardless of the initial state $\Gamma_0$. The first step is to assume a transition path for aggregate capital $\mathbf{K}^i = \left\{K_1^i,K_2^i,...K_T^i\right\}$ such that $T$ is sufficiently large to ensure that $\Gamma_T = \bar{\Gamma}$ and $K_T^i\left(\Gamma_T\right) = \bar{K}\left(\bar{\Gamma}\right)$. The superscript $i$ is an index for the iteration number. The transition path for aggregate capital determines the transition path for both the real wage $\mathbf{w}^i = \left\{w_1^i,w_2^i,...w_T^i\right\}$ and the real return on investment $\mathbf{r}^i = \left\{r_1^i,r_2^i,...r_T^i\right\}$. The exact initial distribution of capital in the first period $\Gamma_1$ can be arbitrarily chosen as long as it satisfies $K_1^i = \frac{S-1}{S}\sum_{s=2}^{S}\sum_{e=e_1}^{e_J}\sum_{b=b_1}^{b_B}\gamma_1(s,e,b)b$ according to market clearing condition \eqref{EqModelGenEquilCapMktClr}. One could also first choose the initial distribution of capital $\Gamma_1$ and then choose an initial aggregate capital stock $K_1^i$ that corresponds to that distribution. As mentioned earlier, the only other restriction on the initial transition path for aggregate capital is that it equal the steady-state level $K_T^i = \bar{K}\left(\bar{\Gamma}\right)$ by period $T$. But the aggregate capital stocks $K_t^i$ for periods $1<t<T$ can be any level.

% Given the initial capital distribution $\Gamma_1$ and the transition paths of aggregate capital $\mathbf{K}^i = \left\{K_1^i,K_2^i,...K_T^i\right\}$, the real wage $\mathbf{w}^i = \left\{w_1^i,w_2^i,...w_T^i\right\}$, and the real return to investment $\mathbf{r}^i = \left\{r_1^i,r_2^i,...r_T^i\right\}$, one can solve for the optimal savings policy rule for each type of $S-1$-aged agent for the last period of his life $b_{S,2} = \phi_1(S-1,e,b)$ using his intertemporal Euler equation, where the ``1" subscript on $\phi$ represents the time $t=1$ savings decision with the real wage $w_1^i$ and real interest rate $r_1^i$.\footnote{Note that the $\Gamma$ and $\Omega$ that usually appear in the policy functions $\phi$ have been dropped because they are assumed in the guess of the transition path $\mathbf{K}^i$.}
% \begin{equation}\label{EqSolMethsTPIGenSmin1Euler}
%    \begin{split}
%       &\Bigl(\bigl[1 + r_1^i-\delta\bigr]b_{S-1,1} + w_1^i e_{S-1,1}n(S-1) - b_{S,2}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad\quad \beta\left(1 + r_2^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_2^i-\delta\bigr]b_{S,2} + w_2^i e_{S,2}n(S)\Bigr)^{-\sigma}\biggr]
%    \end{split}
% \end{equation}

% The final two savings decisions of each type of $S-2$-aged household in period 1, $b_{S-1,2}$ and $b_{S,3}$, are characterized by the following two intertemporal Euler equations and are solved by backward induction.
% \begin{equation}\label{EqSolMethsTPIGenSmin2Euler}
%    \begin{split}
%       &\Bigl(\bigl[1 + r_1^i-\delta\bigr]b_{S-2,1} + w_1^i e_{S-2,1}n(S-2) - b_{S-1,2}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad \beta\left(1 + r_2^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_2^i-\delta\bigr]b_{S-1,2} + w_2^i e_{S-1,2}n(S-1) - b_{S,3}\Bigr)^{-\sigma}\biggr] \\
%       &\quad\Bigl(\bigl[1 + r_2^i-\delta\bigr]b_{S-1,2} + w_2^i e_{S-1,2} n(S-1) - b_{S,3}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad\quad \beta\left(1 + r_3^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_3^i-\delta\bigr]b_{S,3} + w_3^i e_{S,3}n(S)\Bigr)^{-\sigma}\biggr]
%    \end{split}
% \end{equation}
% The solution to the second equation delivers the savings policy function for $b_{S,3} = \phi_2(S-1,e,b)$. This policy function is then used in the first equation of \eqref{EqSolMethsTPIGenSmin2Euler} in order to solve for the policy function $b_{S-1,2} = \phi_1(S-2,e,b)$.

% This process is repeated for every age of household in $t=1$ down to the age-1 household at time $t=1$. This household solves the full set of $S-1$ savings decisions characterized by the following equations.
% \begin{equation}\label{EqSolMethsTPIGen1Euler}
%    \begin{split}
%       &\Bigl(w_1^i e_{1,1}n(1) - b_{2,2}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad \beta\left(1 + r_2^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_2^i-\delta\bigr]b_{2,2} + w_2^i e_{2,2}n(2) - b_{3,3}\Bigr)^{-\sigma}\biggr] \\
%       &\Bigl(\bigl[1 + r_2^i-\delta\bigr]b_{2,2} + w_2^i e_{2,2} n(2) - b_{3,3}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad \beta\left(1 + r_3^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_3^i-\delta\bigr]b_{3,3} + w_3^i e_{3,3}n(3) - b_{4,4}\Bigr)^{-\sigma}\biggr] \\
%       &\quad\quad\quad\quad\quad\quad\quad\quad\vdots \\
%       &\Bigl(\bigl[1 + r_{S-1}^i-\delta\bigr]b_{S-1,S-1} + w_{S-1}^i e_{S-1,S-1} n(S-1) - b_{S,S}\Bigr)^{-\sigma} = ... \\
%       &\quad\quad\quad\quad\quad \beta\left(1 + r_S^i-\delta\right)E\biggl[\Bigl(\bigl[1 + r_S^i-\delta\bigr]b_{S,S} + w_S^i e_{S,S}n(S)\Bigr)^{-\sigma}\biggr]
%    \end{split}
% \end{equation}

% Once the remaining lifetime decision rules have been solved for all households alive in period $t=1$, the set of first period policy functions $\phi_1(s,e,b)$ is complete. The first period policy function $\phi_1(s,e,b)$ is then combined with the first period distribution of capital $\Gamma_1$ to compute the second period distribution of capital $\Gamma_2$.The second period distribution of capital $\Gamma_2$ implies an aggregate capital stock $K_2^{i'}$ through \eqref{EqModelGenEquilCapMktClr} which is not equal to the originally assumed second period aggregate capital stock $K_2^{i'}\neq K_2^i$, in general.

% For every $1<t<T$, the set of period-$t$ policy functions $\phi_t(s,e,b)$ is computed by solving the full set of $S-1$ savings decisions for the age-1 household at period $t$. The policy rule $\phi_t(s,e,b)$ is then combined with the distribution of savings $\Gamma_t$ computed in period $t-1$ in order to compute the distribution of savings in the next period $\Gamma_{t+1}$. The new $\Gamma_{t+1}$ implies an aggregate capital stock $K_{t+1}^{i'}$ that, in general, is not equal to the originally assumed aggregate capital stock $K_{t+1}^{i'}\neq K_{t+1}^{i}$.\footnote{A check here for whether $T$ is large enough is if $K_T^{i'}=\bar{K}\left(\bar{\Gamma}\right)$ as well as $K_{T+1}^{i'}$ and $K_{T+2}^{i'}$. If not, then $T$ needs to be larger.}

% Once this process has been completed for all $1<t<T$, a new transition path for the aggregate capital stock has been computed $\mathbf{K}^{i'}=\{K_1^{i'},K_2^{i'},...K_T^{i'}\}$. Let $\lvert\cdot\rvert$ be the sup norm. Then the fixed point necessary for the equilibrium transition path from Definition \ref{DefModelGenEquilNonSS} has been found when the distance between $\mathbf{K}^{i'}$ and $\mathbf{K}^{i}$ is arbitrarily close to zero.
% \begin{equation}\label{EqSolMethsTPIdist}
%    \lvert\mathbf{K}^{i'} - \mathbf{K}^{i}\rvert < \ve \quad\text{for}\quad \ve>0
% \end{equation}
% If the fixed point has not been found $\lvert\mathbf{K}^{i'} - \mathbf{K}^{i}\rvert > \ve$, then a new transition path for the aggregate capital stock is generated as a convex combination of $\mathbf{K}^{i'}$ and $\mathbf{K}^{i}$.
% \begin{equation}\label{EqSolMethsTPInewpath}
%    \mathbf{K}^{i+1} = \rho\mathbf{K}^{i'} + (1-\rho)\mathbf{K}^{i} \quad\text{for}\quad \rho\in(0,1)
% \end{equation}
% This process is repeated until the initial transition path for the aggregate capital stock is consistent with the transition path implied by those beliefs and household and firm optimization.

% In essence, the TPI method iterates on beliefs represented by a transition path for the aggregate capital stock $\mathbf{K}^i$ until a fixed point in beliefs is found that are consistent with the transition path implied by optimization based on those beliefs.

% \begin{figure}[htb]\centering \captionsetup{width=4.0in}
%    \caption{\label{FigTPIpath}\textbf{TPI computed equilibrium transition path for aggregate capital stock $K_t$}}
%    \fbox{\resizebox{4.0in}{3.2in}{\includegraphics{FigTPIpath.pdf}}}
% \end{figure}

% Figure \ref{FigTPIpath} shows the TPI computed transition path of the aggregate capital stock using the same calibrated example from the steady-state computation in Section \ref{SecModelGenEquil}. A detailed outline of the computational algorithm is given in Appendix \ref{AppTPIpathCompAlg}. The benchmark TPI computational method shows the aggregate capital stock $K_t$ converging to its steady state $\bar{K}$ in roughly 60 periods. It took 31 hours, 59 minutes, and 39 seconds to compute the solution by time path iteration.

% The equilibrium transition path overshoots the steady state and takes 60 periods to arrive at the new steady state because the initial state is so different from the new steady state. The initial state $K_1=5.45$ in the time path in Figure \ref{FigTPIpath} is 28 percent less than the steady-state aggregate capital stock level $\bar{K}=7.62$ to which it must converge. Also, the initial distribution of savings across household types $\Gamma_1$ as defined in Section \ref{SecModelGenHous} is very different from the steady-state distribution of savings across household types $\bar{\Gamma}$.\footnote{More specifically, we assumed a uniform initial distribution of savings across all types, which resulted in an initial aggregate capital stock of $K_1=5.45$. The steady-state distribution $\bar{\Gamma}$ that results in $\bar{K}=7.62$ is not uniform.}







\clearpage
\end{spacing}

\newpage
\renewcommand{\theequation}{A.\arabic{section}.\arabic{equation}}
                                                 % redefine the command that creates the section number
\renewcommand{\thesection}{A-\arabic{section}}   % redefine the command that creates the equation number
\setcounter{equation}{0}                         % reset counter
\setcounter{section}{0}                          % reset section number
\section*{APPENDIX}                              % use *-form to suppress numbering

\section{Calibration of ability process}\label{AppAbilCalib}

  The calibration of the ability process $e_j(s)$ is as follows.  First, the ability types themselves must be calibrated. For each age group $s \in S$, the hourly wage rates are sorted into $J$ percentile groups.  The ability type for each percentile group is the median wage for the percentile group, divided by the average wage of all individuals in the data set.

  The data used to calibrate the ability types were obtained from the Current Population Survey.\footnote{U.S. Census Bureau, Dataferret, Current Population Survey, 2014. The variables $PRTAGE$ and $PTERNHLY$ were used for the age and hourly wage rate of individuals, respectively. \\ [-2pt]} Individuals younger than 20 and older than 79 are dropped from the data. This is due to the extremely small amount of observations for ages outside of those bounds. The data was truncated to allow for either method. Due to a limited number of observations in the survey who included their hourly wage, data was taken from the months of January, February, March, April, and May 2014.  The ability types were then calculated for each month, and then an average was taken of the five calibrations of the ability types in order to produce a final calibration to be used in the model.

  The ability types evolve according to a Markov process, which is altered depending on the specifications of the model.  An individual in period $s$ and of ability type $j$ faces a distribution which will determine in which ability type they fall in the period $s+1$.  In this paper, individuals are assigned ability types at the beginning of their life, and cannot change types later on.  This Markov process is simply an identity matrix for each age group.

  However, the model will readily accept a more complex Markov process.  The data used to create the Markov process comes from the Panel Study of Income Dynamics (PSID) for 1999 and 2001. \footnote{Panel Study of Income Dynamics, public use dataset. Produced and distributed by the Survey Research Center, Institute for Social Research, University of Michigan, Ann Arbor, MI (2014). The variables for age and wage in 1999 and age and wage in 2001 are $ER33504$, $ER33537O$, $ER33604$, and $ER33628O$, respectively.\\ [-2pt]} Again, since $S=60$, only individuals with ages 20 through 79 are included.  Wages in 1999 are multiplied by 1.06303 to convert them to 2001 wages. Individuals without wage information in both years are dropped. Due to the low number of observations per age group, one Markov process is generated which is applied to all age groups in the model. \cite{Nishiyama:2003} noted that this Markov transition matrix was reasonably consistent across age cohorts, and so using the same process for all cohorts should not present a problem in the model.

  To generate the transition matrix, the 1999 and 2001 wages are sorted into $J$ percentile groups.  For each percentile group in 2001, the number of individuals that came from each of the percentile groups in 1999 are counted.  This generates $J ** 2$ summations of individuals, $J$ for each percentile group.  Then, the $J$ summations for the first percentile group in 2001 are divided by the count of individuals in the first percentile group in 1999.  Next, the $J$ summations for the second percentile group in 2001 are divided by the count of individuals in the second percentile group in 1999.  This continues through the $J^{th}$ percentile group.  We then have a $J \times J$ matrix of probabilities, where the first row is the probability of being in the first percentile group, given that one is in the $j^{th}$ percentile group before (where $j$ indicates the column of the matrix), and so on.

  Because this Markov transitional matrix represents the probabilities of changing abilities types after two years, we must take the ``square root'' of the matrix.  This process is described in the Python code for the model, and involves diagonalizing the matrix and taking the square root of the diagonalized matrix.  Finally, the Markov matrix is then raised to the $60/S$ power, denoting the number of years that separate each age cohort.

% Do we need to cite the data set sources? (for both e and f)


\newpage
\section{Constraints on individual borrowing}\label{AppBorConstr}

  \setcounter{equation}{0}

  As described in Section \ref{SecIndProb}, individuals are allowed to borrow $b_{j,s,t}$ for some $j$ and $s$ in period $t$. However, two constraints must hold. First, the individual must be able to pay back the balance with interest $r_{t+1}$ in the next period without driving consumption in the next period $c_{j,s+1,t+1}$ to be nonpositive. Let $\bar{b}_{j,s,t}$ be the minimum value of savings in a period.
  \begin{equation}\label{EqSavMin}
    b_{j,s,t}\geq\bar{b}_{j,s,t} \quad\forall j,s,t
  \end{equation}
  Rearranging the bugdet constraints in \eqref{EqBC1}, \eqref{EqBC2}, and \eqref{EqBC3} and using backward induction gives the following expressions for $\bar{b}_{j,s,t}$,
  \begin{equation}\label{EqBorConsts}
    \begin{split}
      \bar{b}_{j,S,t} &= \frac{\ve - w_te_j(S)l(S)}{1+r_t}  \\
      \bar{b}_{j,S-1,t-1} &= \frac{\ve + \bar{b}_{j,S,t} - w_{t-1}e_j(S-1)l(S-1)}{1+r_{t-1}} \\
      &\vdots \\
      \bar{b}_{j,2,t-S+2} &= \frac{\ve + \bar{b}_{j,3,t-S+3} - w_{t-S+2}e_j(2)l(2)}{1+r_{t-S+2}}
    \end{split}
  \end{equation}

  In addition to the individual borrowing constraint \eqref{EqSavMin}, a strict aggregate borrowing constraint must be met. That is, the aggregate capital stock must be strictly positive.
  \begin{equation}\label{EqAggrCapConstr}
    K_t > 0 \quad\forall t
  \end{equation}


\newpage
\section{Solving for steady-state equilibrium}\label{AppSSsolve}

  \setcounter{equation}{0}

  This section describes the solution method for the steady-state equilibrium described in Definition \ref{DefEquilSS}.

  \begin{enumerate}
    \item Choose an initial guess for the steady-state distribution of capital $\bar{b}_{j,s+1}$ for all $j$ and $s=1,2,...S-1$.
      \begin{itemize}
        \item choose some small positive number that is strictly less that is small enough to be less than the minimum income that an individual might have $\bar{w}e_j(s)l(s)$.
      \end{itemize}
    \item Perform an unconstrained root finder that chooses $\bar{b}_{j,s+1}$ that solves the $J\times(S-1)$ steady-state Euler equations \eqref{EqSSeuler}.
    \item Make sure none of the implied steady-state consumptions $\bar{c}_{j,s,t}$ is less-than-or-equal-to zero.
      \begin{itemize}
        \item If one consumption is less-than-or-equal-to zero $\bar{c}_{j,s}\leq 0$, then try different starting values.
        \item If that does not work, then we must perform the root finding operation as a constrained minimization problem that puts a maximum value on $\bar{b}_{j,s+1}$.
      \end{itemize}
    \item Make sure that none of the Euler errors is too large in absolute value. A steady-state Euler error is the following, which is supposed to be close to zero for all $j$ and $s=1,2,...S-1$:
      \begin{equation}\label{EqSSeulerr}
        \frac{\beta \left(1+\bar{r}\right)\left(\bar{c}_{j,s+1}\right)^{-\sigma}}{\left(\bar{c}_{j,s}\right)^{-\sigma}} - 1
      \end{equation}
    \item Make sure that the unconstrained solution satisfies the individual borrowing constraints in \eqref{EqSavMin} and \eqref{EqBorConsts}.
      \begin{itemize}
        \item If any individual's borrowing constraint is not satisfied using the unconstrained root finding operation, rerun the root finding operation in step (ii) as a constrained minimization problem with the borrowing constraints imposed on those individuals.
        \item Repeat steps (ii) through (v) until all the individual borrowing constraints are met.
      \end{itemize}
    \item Make sure that the solution satisfies the aggregate borrowing constraint \eqref{EqAggrCapConstr}.
      \begin{itemize}
        \item If it does not, what is the least distortionary upward adjustment to individual steady-state savings $\bar{b}_{j,s+1}$?
      \end{itemize}
  \end{enumerate}


\newpage
\section{Solving for non-steady-state equilibrium by time path iteration}\label{AppNonSSsolve}

  \setcounter{equation}{0}
  \renewcommand\theenumi{\arabic{enumi}}
  \renewcommand\theenumii{\alph{enumii}}
  \renewcommand\theenumiii{\roman{enumiii}}

  % The computation of the time path iteration (TPI) transition path described in Section \ref{SecSolMethsTPI} requires the following steps. The MatLab code for this TPI transition path computation is available upon request.
  % \begin{enumerate}
  %    \item Using the parameterization from the steady-state computation, and choose the value for $T$ at which the non-steady-state transition path should have converged to the steady state. We used $T=60$.
  %    \item Choose an initial state of the aggregate capital stock $K_1$. Choose an initial distribution of capital $\Gamma_1$ consistent with $K_1$ according to \eqref{EqModelGenEquilCapMktClr}.
  %       \begin{itemize}
  %          \item We chose an initial capital stock of $K_1=5.45$, which is consistent with a simple initial distribution of wealth---the distribution of ability by age spread across all possible wealth levels $\gamma_1(s,e,b)= f_s(e)/\left[(S-1)B\right]$ for all $s$, $e$, and $b$.
  %       \end{itemize}
  %    \item Conjecture a transition path for the aggregate capital stock $\mathbf{K}^i=\{K^i_t\}_{t=1}^\infty$ where the only requirements are that $K^i_1=K_1$ is your initial state and that $K^i_t=\bar{K}$ for all $t\geq T$. The conjectured transition path of the aggregate capital stock $\mathbf{K}^i$, along with the exogenous aggregate labor supply from \eqref{EqModelGenEquilLabMktClr}, implies specific transition paths for the real wage $\mathbf{w}^i=\{w^i_t\}_{t=1}^\infty$ and the real interest rate $\mathbf{r}^i=\{r^i_t\}_{t=1}^\infty$ through expressions \eqref{EqModelGenCobbDougProd}, \eqref{EqModelGenCobbDougRealWage}, and \eqref{EqModelGenCobbDougRentRate}.
  %    \item With the conjectured transition paths $\mathbf{w}^i$ and $\mathbf{r}^i$, one can solve for the lifetime policy functions of each household alive at time $t=1$ by backward induction using the Euler equations of the form \eqref{EqSolMethsTPIGen1Euler}. Rows 1 through 5 of Table \ref{TabAppTPIpathCompAlgPolFunc} illustrate this process.
  %       \begin{itemize}
  %          \item The first line is solving for the solution of the individual who is age $S-1$ at time $t=1$ obtaining $b_{2,2}=\phi_1(S-1,e,b)$ from equation \eqref{EqSolMethsTPIGenSmin1Euler}.
  %          \item Each subsequent row from Table \ref{TabAppTPIpathCompAlgPolFunc} represents the solution of the lifetime savings policy functions of an individual with more years remaining in their life at time $t=1$, down the the person who is age $s=1$ at time $t=1$ and has the entire set of $S-1$ policy functions characterized by \eqref{EqSolMethsTPIGen1Euler}.
  %       \end{itemize}

  % \begin{table}[htbp] \centering \captionsetup{width=6.0in}
  % \caption{\label{TabAppTPIpathCompAlgPolFunc}\textbf{TPI backward induction policy function solution method}}
  %     \begin{threeparttable}
  %     \begin{tabular}{>{\scriptsize}c >{\scriptsize}c >{\scriptsize}c >{\scriptsize}c >{\scriptsize}c >{\scriptsize}c >{\scriptsize}c}
  %         \hline\hline
  %         $t=1$ & $t=2$ & $t=3$ & $\cdot$ & $t=S-2$ & $t=S-1$ & $t=S$ \\
  %         \hline
  %         $\phi_1(S-1,e,b)$ & & & & & & \\
  %         $\phi_1(S-2,e,b)$ & $\phi_2(S-1,e,b)$ & & & & & \\
  %         $\phi_1(S-3,e,b)$ & $\phi_2(S-2,e,b)$ & $\phi_3(S-1,e,b)$ & & & & \\
  %         $\vdots$ & $\vdots$ & $\vdots$ & & & & \\
  %         $\phi_1(2,e,b)$ & $\phi_2(3,e,b)$ & $\phi_3(4,e,b)$ & $\cdots$ & & & \\
  %         $\phi_1(1,e,b)$ & $\phi_2(2,e,b)$ & $\phi_3(3,e,b)$ & $\cdots$ & $\phi_{S-2}(S-1,e,b)$ & & \\
  %         & $\phi_2(1,e,b)$ & $\phi_3(2,e,b)$ & $\cdots$ & $\phi_{S-2}(S-2,e,b)$ & $\phi_{S-1}(S-1,e,b)$ & \\
  %         &  & $\phi_3(1,e,b)$ & $\cdots$ & $\phi_{S-2}(S-3,e,b)$ & $\phi_{S-1}(S-2,e,b)$ & $\phi_{S}(S-1,e,b)$ \\
  %         & & & & $\vdots$ & $\vdots$ & $\vdots$ \\
  %         \hline
  %         $\Gamma_2,K_2$ & $\Gamma_3,K_3$ & $\Gamma_4,K_4$ & $\cdots$ & $\Gamma_{S-1},K_{S-1}$ & $\Gamma_{S},K_{S}$ & $\Gamma_{S+1},K_{S+1}$ \\
  %         \hline\hline
  %     \end{tabular}
  %     \end{threeparttable}
  % \end{table}

  %    \item In similar fashion to step (4), solve for the lifetime policy functions by backward induction for the age $s=1$ household at times $2\leq t \leq T$. In Table \ref{TabAppTPIpathCompAlgPolFunc}, this means solving for the policy functions in the last two rows down to the age $s=1$ household at time $t=T$.
  %    \item Each column in Table \ref{TabAppTPIpathCompAlgPolFunc} represents a complete set of policy functions for the corresponding period. Using the initial distribution of wealth $\Gamma_1$ and all the period $t=1$ policy functions $\phi_1(s,e,b)$ for the households alive at time $t=1$, the next period distribution of wealth $\Gamma_2$ and the corresponding aggregate capital stock $K^{i'}_2$ can be calculated. Consecutively repeat this procedure for each time period (column of Table \ref{TabAppTPIpathCompAlgPolFunc}) until a new transition path for the aggregate capital stock has been computed $\mathbf{K}^{i'}=\{K^{i'}_t\}_{t=1}^T$.
  %    \item Generate a new guess for the transition path of the aggregate capital stock $\mathbf{K}^{i+1}$ as a convex combination of the initially conjectured transition path $\mathbf{K}^{i}$ and the newly generated transition path $\mathbf{K}^{i'}$.
  %       \begin{equation*}
  %          \mathbf{K}^{i+1} = \rho\mathbf{K}^{i'} + (1-\rho)\mathbf{K}^i \quad\text{where}\quad \rho\in(0,1)
  %       \end{equation*}
  %    \item Repeat steps (4) through (7) until the distance between $\mathbf{K}^{i'}$ and $\mathbf{K}^{i}$ is arbitrarily close to zero, where $i$ is the index of the iteration number. Let $|\cdot|$ be the sup norm and let $\ve>0$ be some scalar arbitrarily close to zero. Then the rational expectations equilibrium transition path of the economy is found when when $\left|\mathbf{K}^{i'} - \mathbf{K}^i\right| < \ve$.
  % \end{enumerate}

  % In our example, the computation of the TPI transition path took 31 hours, 59 minutes, and 39 seconds. Figure \ref{FigTPIpath} shows the transition path of the aggregate capital stock from its initial state at $K_1$ to the steady state $\bar{K}$. The aggregate capital stock arrived at its steady state in about 60 periods.

  % \clearpage


\newpage
\bibliography{DynScoreMacro}



\newpage
\renewcommand{\theequation}{T.\arabic{section}.\arabic{equation}}
                                                 % redefine the command that creates the section number
\renewcommand{\thesection}{T-\arabic{section}}   % redefine the command that creates the equation number
\setcounter{equation}{0}                         % reset counter
\setcounter{section}{0}                          % reset section number
\section*{TECHNICAL APPENDIX}


\section{Structures to add to the model and order}\label{TAppSteps}

  \begin{enumerate}
    \item Endogenize labor
    \item Make sure bond holdings are correct
    \item Add demographics
    \item Add household tax structures
    \item Add firm structures
  \end{enumerate}


\newpage
\section{Comments and Notes}\label{TAppComments}

  \begin{itemize}
    \item We don't need to put the PSID acknowledgment text in our thanks on the title page. We just cite in our ability calibration appendix that we used any PSID data.
  \end{itemize}


\end{document}
